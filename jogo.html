<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Santa Teresinha â€“ Jardim</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  overflow: hidden;
  font-family: Arial, sans-serif;
  background: #1d1026;
}

/* HUD */
#hud {
  position: fixed;
  top: 10px;
  left: 10px;
  background: rgba(0,0,0,0.6);
  color: #fff;
  padding: 10px;
  border-radius: 8px;
  z-index: 10;
}

button {
  margin-top: 6px;
  width: 140px;
  cursor: pointer;
}

/* VIEWPORT */
#viewport {
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  cursor: grab;
}

/* MAPA */
#mapa {
  width: 2400px;
  height: 1600px;
  background: url("cenario.png") center/cover;
  position: relative;
  transform-origin: 0 0;
}

/* SANTA */
#santa {
  position: absolute;
  width: 96px;
  left: 1200px;
  top: 800px;
  cursor: pointer;
}

/* FLOR */
.flower {
  position: absolute;
  width: 32px;
  height: 32px;
  background: url("flor.png") no-repeat center/contain;
  opacity: 0.4;
  transform: scale(0.5);
  transition: all 0.5s;
  pointer-events: none;
}

.flower.ready {
  opacity: 1;
  transform: scale(1);
  pointer-events: auto;
  cursor: pointer;
}
</style>
</head>

<body>

<div id="hud">
  ðŸŒ¸ Flores: <span id="flores">0</span><br>
  Por clique: <span id="porClique">1</span><br>
  Auto: <span id="auto">0</span>/s<br>
  <button onclick="uparClique()">Upar clique</button>
  <button onclick="uparAuto()">Upar auto</button>
</div>

<div id="viewport">
  <div id="mapa">
    <img src="santa.png" id="santa">
  </div>
</div>

<script>
/* ===== ESTADO ===== */
let flores = 0;
let porClique = 1;
let auto = 0;

const TEMPO_SPAWN = 8000;
const TEMPO_CRESCER = 5000;

/* ===== ELEMENTOS ===== */
const floresEl = document.getElementById("flores");
const porCliqueEl = document.getElementById("porClique");
const autoEl = document.getElementById("auto");
const mapa = document.getElementById("mapa");
const santa = document.getElementById("santa");

/* ===== HUD ===== */
function atualizarHUD() {
  floresEl.textContent = flores;
  porCliqueEl.textContent = porClique;
  autoEl.textContent = auto;
  salvar();
}

/* ===== CLIQUE ===== */
santa.onclick = () => {
  flores += porClique;
  atualizarHUD();
};

/* ===== UPGRADES ===== */
function uparClique() {
  if (flores >= 10) {
    flores -= 10;
    porClique++;
    atualizarHUD();
  }
}

function uparAuto() {
  if (flores >= 20) {
    flores -= 20;
    auto++;
    atualizarHUD();
  }
}

/* ===== AUTO ===== */
setInterval(() => {
  flores += auto;
  atualizarHUD();
}, 1000);

/* ===== FLORES NO MAPA ===== */
function spawnFlor() {
  const flor = document.createElement("div");
  flor.className = "flower";

  flor.style.left = Math.random() * 2200 + "px";
  flor.style.top = Math.random() * 1400 + "px";

  mapa.appendChild(flor);

  setTimeout(() => {
    flor.classList.add("ready");
    flor.onclick = () => {
      flores += 5;
      atualizarHUD();
      flor.remove();
    };
  }, TEMPO_CRESCER);
}

setInterval(spawnFlor, TEMPO_SPAWN);

/* ===== MOVIMENTO SANTA ===== */
setInterval(() => {
  const x = Math.random() * 2200;
  const y = Math.random() * 1400;
  santa.style.transition = "2s linear";
  santa.style.left = x + "px";
  santa.style.top = y + "px";
}, 4000);

/* ===== ZOOM + PAN ===== */
let scale = 1;
let isDragging = false;
let startX, startY, originX = 0, originY = 0;

const viewport = document.getElementById("viewport");

viewport.onwheel = e => {
  e.preventDefault();
  scale += e.deltaY * -0.001;
  scale = Math.min(Math.max(0.5, scale), 2);
  mapa.style.transform = `translate(${originX}px, ${originY}px) scale(${scale})`;
};

viewport.onmousedown = e => {
  isDragging = true;
  startX = e.clientX - originX;
  startY = e.clientY - originY;
};

window.onmouseup = () => isDragging = false;

window.onmousemove = e => {
  if (!isDragging) return;
  originX = e.clientX - startX;
  originY = e.clientY - startY;
  mapa.style.transform = `translate(${originX}px, ${originY}px) scale(${scale})`;
};

/* ===== SALVAR ===== */
function salvar() {
  localStorage.setItem("save", JSON.stringify({ flores, porClique, auto }));
}

function carregar() {
  const save = JSON.parse(localStorage.getItem("save"));
  if (!save) return;
  flores = save.flores;
  porClique = save.porClique;
  auto = save.auto;
  atualizarHUD();
}

carregar();
</script>

</body>
</html>
