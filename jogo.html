<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Jogo Santa Terezinha</title>

<style>

body{
    margin:0;
    background:black;
    overflow:hidden;
}

canvas{
    display:block;
    margin:auto;
    image-rendering: pixelated;
}

#ui{
    position:absolute;
    top:10px;
    left:10px;
    color:white;
    font-size:24px;
    font-family:Arial;
}

</style>

</head>
<body>

<div id="ui">
Pontos: <span id="pontos">0</span>
</div>

<canvas id="gameCanvas" width="960" height="540"></canvas>

<script>

// =============================
// CONFIG
// =============================

const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

ctx.imageSmoothingEnabled = false;

const TILE = 64;


// =============================
// PONTOS
// =============================

let pontos = 0;

function atualizarUI(){
    document.getElementById("pontos").innerText =
        Math.floor(pontos);
}


// pontos automáticos (idle)
setInterval(()=>{
    pontos += 1;
    atualizarUI();
},1000);


// =============================
// IMAGENS
// =============================

const grama = new Image();
grama.src = "grama.png";

const biblioteca = new Image();
biblioteca.src = "biblioteca.png";


// =============================
// POSIÇÕES
// =============================

let bibliotecaX = canvas.width/2 - 128;
let bibliotecaY = canvas.height/2 - 128;

let bibliotecaW = 256;
let bibliotecaH = 256;


// =============================
// CLIQUE
// =============================

canvas.onclick = function(e){

    const rect = canvas.getBoundingClientRect();

    const mouseX = e.clientX - rect.left;
    const mouseY = e.clientY - rect.top;

    if(
        mouseX >= bibliotecaX &&
        mouseX <= bibliotecaX + bibliotecaW &&
        mouseY >= bibliotecaY &&
        mouseY <= bibliotecaY + bibliotecaH
    ){
        pontos += 10;
        atualizarUI();
    }

}


// =============================
// DESENHO
// =============================

function desenharGrama(){

    for(let x=0; x<canvas.width; x+=TILE){

        for(let y=0; y<canvas.height; y+=TILE){

            ctx.drawImage(
                grama,
                x,
                y,
                TILE,
                TILE
            );

        }

    }

}


function desenharBiblioteca(){

    ctx.drawImage(
        biblioteca,
        bibliotecaX,
        bibliotecaY,
        bibliotecaW,
        bibliotecaH
    );

}


// =============================
// LOOP
// =============================

function loop(){

    ctx.clearRect(0,0,canvas.width,canvas.height);

    desenharGrama();

    desenharBiblioteca();

    requestAnimationFrame(loop);

}

loop();

</script>

</body>
</html>
