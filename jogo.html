<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Jardim de Santa Teresinha</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>

body{
margin:0;
overflow:hidden;
font-family:Arial;
}

#game{
position:relative;
width:100vw;
height:100vh;
overflow:hidden;
background:black;
}

#camera{
position:absolute;
width:3000px;
height:3000px;
transform:translate(0px,0px);
}

#mapCanvas{
position:absolute;
image-rendering:pixelated;
}

#santa{
position:absolute;
width:120px;
left:1500px;
top:1500px;
transform:translate(-50%,-50%);
z-index:10;
}

.flor{
position:absolute;
width:40px;
z-index:20;
cursor:pointer;
}

#hud{
position:fixed;
top:20px;
left:20px;
background:white;
padding:15px;
border-radius:10px;
z-index:50;
}

#upgrades{
position:fixed;
right:20px;
top:50%;
transform:translateY(-50%);
display:flex;
flex-direction:column;
gap:10px;
z-index:50;
}

button{
padding:12px;
border:none;
border-radius:10px;
background:#7b4bb7;
color:white;
font-weight:bold;
cursor:pointer;
}

</style>
</head>

<body>

<div id="game">

<div id="camera">

<canvas id="mapCanvas" width="3000" height="3000"></canvas>

<img src="santa.png" id="santa">

</div>

</div>

<div id="hud">

üå∏ Flores: <span id="flores">0</span><br><br>
üëÜ Clique: <span id="porClique">1</span><br>
‚è± Auto: <span id="auto">0</span><br>
üíé Valor: <span id="valorFlor">3</span>

</div>

<div id="upgrades">

<button onclick="uparClique()">
Upar Clique (<span id="c1">10</span>)
</button>

<button onclick="uparAuto()">
Upar Auto (<span id="c2">20</span>)
</button>

<button onclick="uparFlor()">
Upar Flor (<span id="c3">30</span>)
</button>

</div>

<script>

/* SAVE */

let flores=Number(localStorage.getItem("flores"))||0
let porClique=Number(localStorage.getItem("porClique"))||1
let auto=Number(localStorage.getItem("auto"))||0
let valorFlor=Number(localStorage.getItem("valorFlor"))||3

let custoClique=10
let custoAuto=20
let custoFlor=30

/* HUD */

let floresEl=document.getElementById("flores")
let porCliqueEl=document.getElementById("porClique")
let autoEl=document.getElementById("auto")
let valorFlorEl=document.getElementById("valorFlor")

function salvar(){

localStorage.setItem("flores",flores)
localStorage.setItem("porClique",porClique)
localStorage.setItem("auto",auto)
localStorage.setItem("valorFlor",valorFlor)

}

function atualizarHUD(){

floresEl.textContent=flores
porCliqueEl.textContent=porClique
autoEl.textContent=auto
valorFlorEl.textContent=valorFlor

document.getElementById("c1").textContent=custoClique
document.getElementById("c2").textContent=custoAuto
document.getElementById("c3").textContent=custoFlor

salvar()

}

/* CANVAS */

let canvas=document.getElementById("mapCanvas")
let ctx=canvas.getContext("2d")

let TILE=32
let LIB=64

/* IMAGENS */

let grass=new Image()
grass.src="./tiles/ground/grass.png"

let library=new Image()
library.src="./tiles/library_tileset.png"

/* LOAD CONTROL */

let carregadas=0

function carregou(){

carregadas++

if(carregadas==2){

desenharMapa()

}

}

grass.onload=carregou
library.onload=carregou

/* MAP */

function desenharGrama(){

for(let y=0;y<3000;y+=TILE){

for(let x=0;x<3000;x+=TILE){

ctx.drawImage(grass,x,y,TILE,TILE)

}

}

}

function libTile(tx,ty,x,y){

ctx.drawImage(

library,
tx*LIB,
ty*LIB,
LIB,
LIB,
x,
y,
LIB,
LIB

)

}

function desenharBiblioteca(){

let x=200
let y=200

libTile(0,0,x,y)
libTile(1,0,x+64,y)
libTile(2,0,x+128,y)

libTile(0,2,x,y+64)
libTile(1,2,x+64,y+64)
libTile(2,2,x+128,y+64)

libTile(1,1,x+64,y+128)

}

function desenharMapa(){

ctx.clearRect(0,0,3000,3000)

desenharGrama()

desenharBiblioteca()

}

/* FLORES */

let camera=document.getElementById("camera")

function criarFlor(){

if(Math.random()>0.5)return

let f=document.createElement("img")

f.src="flor.png"

f.className="flor"

f.style.left=Math.random()*2900+"px"
f.style.top=Math.random()*2900+"px"

f.onclick=function(){

flores+=valorFlor

f.remove()

atualizarHUD()

}

camera.appendChild(f)

}

setInterval(criarFlor,2000)

/* CLICK */

document.getElementById("game").onclick=function(e){

if(e.target.classList.contains("flor"))return

flores+=porClique

atualizarHUD()

}

/* AUTO */

setInterval(function(){

flores+=auto

atualizarHUD()

},1000)

/* UPGRADES */

function uparClique(){

if(flores>=custoClique){

flores-=custoClique

porClique++

custoClique*=2

atualizarHUD()

}

}

function uparAuto(){

if(flores>=custoAuto){

flores-=custoAuto

auto++

custoAuto*=2

atualizarHUD()

}

}

function uparFlor(){

if(flores>=custoFlor){

flores-=custoFlor

valorFlor+=2

custoFlor*=2

atualizarHUD()

}

}

/* CAMERA */

let camX=1200
let camY=1200

let drag=false
let lastX=0
let lastY=0

let game=document.getElementById("game")

game.onmousedown=function(e){

drag=true

lastX=e.clientX
lastY=e.clientY

}

document.onmouseup=function(){

drag=false

}

document.onmousemove=function(e){

if(!drag)return

let dx=e.clientX-lastX
let dy=e.clientY-lastY

camX-=dx
camY-=dy

camX=Math.max(0,Math.min(3000-window.innerWidth,camX))
camY=Math.max(0,Math.min(3000-window.innerHeight,camY))

camera.style.transform=
`translate(${-camX}px,${-camY}px)`

lastX=e.clientX
lastY=e.clientY

}

/* START */

atualizarHUD()

</script>

</body>
</html>
